# ğŸš€ ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Vast.ai MCP + HunyuanVideo Avatar

Ğ­Ñ‚Ğ¾Ñ‚ Ğ³Ğ°Ğ¹Ğ´ Ğ¿Ğ¾ĞºĞ°Ğ¶ĞµÑ‚, ĞºĞ°Ğº Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ´Ğ²Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:

1. **vastai-mcp** - MCP ÑĞµÑ€Ğ²ĞµÑ€ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ GPU Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°Ğ¼Ğ¸ Ğ² Vast.ai
2. **avatar** - Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ¾Ğ² Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ HunyuanVideo-Avatar

## ğŸ¯ ĞĞ±Ñ‰Ğ¸Ğ¹ ĞĞ±Ğ·Ğ¾Ñ€ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ ĞœĞ°ÑˆĞ¸Ğ½Ğ°  â”‚    â”‚    Vast.ai Cloud    â”‚    â”‚   GPU Ğ˜Ğ½ÑÑ‚Ğ°Ğ½Ñ H100  â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   vastai-mcp    â”‚â”‚â”€â”€â”€â–¶â”‚  â”‚   Vast.ai API   â”‚â”‚â”€â”€â”€â–¶â”‚  â”‚ HunyuanVideo    â”‚â”‚
â”‚  â”‚   MCP Server    â”‚â”‚    â”‚  â”‚                 â”‚â”‚    â”‚  â”‚ Avatar Project  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                     â”‚    â”‚                     â”‚    â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚                     â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚     Claude      â”‚â”‚    â”‚                     â”‚    â”‚  â”‚   Conda Env     â”‚â”‚
â”‚  â”‚   Desktop/AI    â”‚â”‚    â”‚                     â”‚    â”‚  â”‚   + PyTorch     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚                     â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ ĞœĞ°ÑˆĞ¸Ğ½Ğ°

- Python 3.10+
- Git
- SSH ĞºĞ»Ğ¸ĞµĞ½Ñ‚
- Minimum 8GB RAM
- Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚-ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ

### Vast.ai Ğ˜Ğ½ÑÑ‚Ğ°Ğ½Ñ

- **GPU:** H100 SXM Ğ¸Ğ»Ğ¸ H200 (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
- **CPU:** AMD EPYC 9554 (224 cores) @ 3.100GHz
- **RAM:** 1.5TB
- **Storage:** 500GB+ SSD
- **OS:** Ubuntu 24.04.2 LTS x86_64

## ğŸ”§ Ğ§Ğ°ÑÑ‚ÑŒ 1: ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Vast.ai MCP Server

### 1.1 ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

```bash
# ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
git clone https://github.com/CryDevOk/vastai-mcp.git
cd vastai-mcp

# Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
pip install -r requirements.txt

# Ğ˜Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ uv Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ĞµĞµ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ¹ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸
curl -LsSf https://astral.sh/uv/install.sh | sh
uv sync
```

### 1.2 ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ñ„Ğ°Ğ¹Ğ» ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
cp mcp_config.json.example mcp_config.json

# Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
nano mcp_config.json
```

ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ:

```json
{
  "vast_api_key": "your_vast_api_key_here",
  "ssh_key_path": "~/.ssh/id_rsa",
  "default_image": "tensorflow/tensorflow:latest-gpu",
  "auto_attach_ssh": true,
  "auto_label": true,
  "label_prefix": "avatar-gen-"
}
```

### 1.3 ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ API ĞšĞ»ÑÑ‡Ğ° Vast.ai

1. ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸Ñ‚Ğµ Ğ½Ğ° [console.vast.ai](https://console.vast.ai)
2. Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞ¹Ñ‚ĞµÑÑŒ/Ğ²Ğ¾Ğ¹Ğ´Ğ¸Ñ‚Ğµ Ğ² Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚
3. ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸Ñ‚Ğµ Ğ² Ñ€Ğ°Ğ·Ğ´ĞµĞ» "Account" â†’ "API Keys"
4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ API ĞºĞ»ÑÑ‡
5. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ĞºĞ»ÑÑ‡ Ğ² ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ»

### 1.4 ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° SSH ĞšĞ»ÑÑ‡ĞµĞ¹

```bash
# Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ SSH ĞºĞ»ÑÑ‡Ğ¸ (ĞµÑĞ»Ğ¸ Ğ¸Ñ… Ğ½ĞµÑ‚)
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

# ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ Ğ² Vast.ai
cat ~/.ssh/id_rsa.pub
```

Ğ—Ğ°Ñ‚ĞµĞ¼ Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ Ğ² [console.vast.ai](https://console.vast.ai) â†’ Account â†’ SSH Keys

### 1.5 Ğ—Ğ°Ğ¿ÑƒÑĞº MCP Server

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ MCP ÑĞµÑ€Ğ²ĞµÑ€
python server.py

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· uv
uv run server.py
```

### 1.6 Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Claude Desktop

Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ² Ñ„Ğ°Ğ¹Ğ» `claude_desktop_config.json`:

```json
{
  "mcpServers": {
    "vastai": {
      "command": "python",
      "args": ["/path/to/vastai-mcp/server.py"],
      "env": {
        "VAST_API_KEY": "your_vast_api_key_here"
      }
    }
  }
}
```

## ğŸ¬ Ğ§Ğ°ÑÑ‚ÑŒ 2: ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Avatar Project

### 2.1 ĞŸĞ¾Ğ¸ÑĞº Ğ¸ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ GPU Ğ˜Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ vastai-mcp Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰ĞµĞ³Ğ¾ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°:

```bash
# Ğ§ĞµÑ€ĞµĞ· Claude Desktop Ğ¸Ğ»Ğ¸ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ñ‡ĞµÑ€ĞµĞ· MCP
# Ğ˜Ñ‰ĞµĞ¼ H100/H200 Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑÑ‹
search_offers(query="H100 OR H200", limit=10)

# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ
create_instance(
    offer_id=<Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ½Ñ‹Ğ¹_offer_id>,
    image="nvidia/cuda:12.8-devel-ubuntu24.04",
    disk=500,
    ssh=True,
    label="hunyuan-avatar-gen"
)
```

### 2.2 ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ˜Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°

ĞŸĞ¾ÑĞ»Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ:

```bash
# ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑÑƒ Ñ‡ĞµÑ€ĞµĞ· SSH
ssh -i ~/.ssh/id_rsa root@<instance_ip> -p <instance_port>

# Ğ˜Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ MCP ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ
ssh_execute_command(
    remote_host="<instance_ip>",
    remote_user="root",
    remote_port=<instance_port>,
    command="whoami"
)
```

### 2.3 Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Avatar Project

Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ÑĞºÑ€Ğ¸Ğ¿Ñ‚:

```bash
# Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ÑĞºÑ€Ğ¸Ğ¿Ñ‚
wget https://raw.githubusercontent.com/CryDevOk/avatar/main/installation.sh
bash installation.sh
```

Ğ˜Ğ»Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ:

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Miniconda
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash ~/Miniconda3-latest-Linux-x86_64.sh -b -p $HOME/miniconda3
source ~/.bashrc
source ~/miniconda3/bin/activate
~/miniconda3/bin/conda init

# ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ HunyuanVideo-Avatar
git clone https://github.com/Tencent-Hunyuan/HunyuanVideo-Avatar.git
cd HunyuanVideo-Avatar

# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ conda environment
conda create -n HunyuanVideo-Avatar python==3.10.9 -y
conda activate HunyuanVideo-Avatar

# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.4 -c pytorch -c nvidia -y
python -m pip install -r requirements.txt
python -m pip install ninja
python -m pip install decord
python -m pip install git+https://github.com/Dao-AILab/flash-attention.git@v2.6.3

# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Hugging Face CLI Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
python -m pip install "huggingface_hub[cli]"
cd ./weights
huggingface-cli download tencent/HunyuanVideo-Avatar --local-dir ./
cd ../
```

### 2.4 ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Asset Files

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸
mkdir -p assets/input assets/image assets/audio

# ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ¸Ğ· Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ avatar Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
scp -i ~/.ssh/id_rsa -P <instance_port> -r ../avatar/assets/* root@<instance_ip>:~/HunyuanVideo-Avatar/assets/
```

### 2.5 Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ĞĞ²Ğ°Ñ‚Ğ°Ñ€Ğ¾Ğ²

```bash
# ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
scp -i ~/.ssh/id_rsa -P <instance_port> ../avatar/start.sh root@<instance_ip>:~/HunyuanVideo-Avatar/
ssh -i ~/.ssh/id_rsa root@<instance_ip> -p <instance_port> "cd ~/HunyuanVideo-Avatar && bash start.sh"
```

## ğŸ”„ Ğ§Ğ°ÑÑ‚ÑŒ 3: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· MCP

### 3.1 ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ĞŸĞ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½ Ñ‡ĞµÑ€ĞµĞ· MCP:

```python
# ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ‡ĞµÑ€ĞµĞ· MCP
def automated_avatar_generation():
    # 1. ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğ¹ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ
    offers = search_offers(query="H100", limit=5)

    # 2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ
    instance = create_instance(
        offer_id=offers[0]['id'],
        image="nvidia/cuda:12.8-devel-ubuntu24.04",
        disk=500,
        ssh=True
    )

    # 3. ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
    wait_for_instance_ready(instance['id'])

    # 4. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ avatar project
    ssh_execute_command(
        remote_host=instance['ip'],
        remote_user="root",
        remote_port=instance['port'],
        command="wget -O - https://raw.githubusercontent.com/CryDevOk/avatar/main/installation.sh | bash"
    )

    # 5. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ
    ssh_execute_background_command(
        remote_host=instance['ip'],
        remote_user="root",
        remote_port=instance['port'],
        command="cd ~/HunyuanVideo-Avatar && bash start.sh"
    )

    return instance
```

### 3.2 ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ›Ğ¾Ğ³Ğ¸

```bash
# ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ° Ñ‡ĞµÑ€ĞµĞ· MCP
ssh_execute_command(
    remote_host="<instance_ip>",
    remote_user="root",
    remote_port=<instance_port>,
    command="tail -f ~/HunyuanVideo-Avatar/logs/generation.log"
)

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡
ssh_check_background_task(
    remote_host="<instance_ip>",
    remote_user="root",
    remote_port=<instance_port>,
    task_id="<task_id>",
    process_id=<process_id>
)
```

### 3.3 Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²

```bash
# Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾
scp -i ~/.ssh/id_rsa -P <instance_port> -r root@<instance_ip>:~/HunyuanVideo-Avatar/results-single/* ./results/
```

## ğŸ§¹ Ğ§Ğ°ÑÑ‚ÑŒ 4: ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¸ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### 4.1 ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ˜Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°

```bash
# ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ° (ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ´Ğ¸ÑĞº)
stop_instance(instance_id)

# Ğ˜Ğ»Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ
destroy_instance(instance_id)
```

### 4.2 Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ—Ğ°Ñ‚Ñ€Ğ°Ñ‚Ğ°Ğ¼Ğ¸

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°
show_user_info()

# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ° Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
label_instance(instance_id, "avatar-gen-auto-destroy-2h")
```

## ğŸ¯ Ğ§Ğ°ÑÑ‚ÑŒ 5: ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ ĞŸÑ€Ğ¾Ñ†ĞµÑÑ

### 5.1 Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°

```bash
#!/bin/bash
# full-pipeline.sh

set -e

echo "ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½Ğ° Vast.ai + Avatar Generation"

# 1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° nastroĞµĞº
echo "ğŸ“‹ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸..."
python -c "import json; print('âœ… ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ°')" || exit 1

# 2. ĞŸĞ¾Ğ¸ÑĞº Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°
echo "ğŸ” ĞŸĞ¾Ğ¸ÑĞº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… GPU Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ¾Ğ²..."
INSTANCE_DATA=$(python -c "
import server
offers = server.search_offers('H100', limit=3)
print(offers[0]['id'])
")

# 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°
echo "ğŸ—ï¸ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°..."
python -c "
import server
instance = server.create_instance(
    offer_id=$INSTANCE_DATA,
    image='nvidia/cuda:12.8-devel-ubuntu24.04',
    disk=500,
    ssh=True
)
print(f'Instance ID: {instance[\"id\"]}')
"

# 4. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº
echo "âš™ï¸ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° avatar project..."
# ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°

echo "âœ… ĞŸĞ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾!"
```

### 5.2 ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ‡ĞµÑ€ĞµĞ· Claude Desktop

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Claude Desktop Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ:

```
Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ H100 Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ¾Ğ², ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸ HunyuanVideo-Avatar Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ² assets/
```

Claude Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ MCP Ğ´Ğ»Ñ:

- ĞŸĞ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ¾Ğ²
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ GPU Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ°
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· SSH
- Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ²ÑĞµÑ… Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹
- Ğ—Ğ°Ğ¿ÑƒÑĞºĞ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑĞ°

## ğŸ”§ Ğ§Ğ°ÑÑ‚ÑŒ 6: Troubleshooting

### 6.1 Ğ§Ğ°ÑÑ‚Ñ‹Ğµ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ˜Ğ½ÑÑ‚Ğ°Ğ½Ñ Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
show_instance(instance_id)

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ»Ğ¾Ğ³Ğ¾Ğ²
logs(instance_id)
```

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** SSH Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° SSH ĞºĞ»ÑÑ‡ĞµĞ¹
ssh_execute_command(
    remote_host="<instance_ip>",
    remote_user="root",
    remote_port=<instance_port>,
    command="echo 'SSH Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚'"
)
```

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚ GPU Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ GPU
ssh_execute_command(
    remote_host="<instance_ip>",
    remote_user="root",
    remote_port=<instance_port>,
    command="nvidia-smi"
)
```

### 6.2 ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

```bash
# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ FP8 Ğ´Ğ»Ñ ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ğ¸ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸
export USE_FP8=1

# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ĞºĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
export USE_DEEPCACHE=1

# ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ CUDA
export CUDA_VISIBLE_DEVICES=0
```

## ğŸ“Š Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¸ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ğ½Ñ‹Ğµ Ğ Ğ°ÑÑ…Ğ¾Ğ´Ñ‹:

- **H100 SXM:** ~$1.50-3.00/Ñ‡Ğ°Ñ
- **H200:** ~$2.00-4.00/Ñ‡Ğ°Ñ
- **Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ 6 Ğ²Ğ¸Ğ´ĞµĞ¾:** ~2-4 Ñ‡Ğ°ÑĞ°
- **ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ:** $6-16 Ğ·Ğ° Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ»

### Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸:

1. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Spot Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑÑ‹ Ğ´Ğ»Ñ ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ğ¸
2. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºÑƒ
3. ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€ÑŒÑ‚Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· MCP
4. Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾ÑĞ»Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸

## ğŸ‰ Ğ—Ğ°ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ

Ğ­Ñ‚Ğ¾Ñ‚ Ğ³Ğ°Ğ¹Ğ´ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ vastai-mcp Ğ¸ avatar Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°Ğ¼Ğ¸, Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ĞµÑÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ AI Ğ°Ğ²Ğ°Ñ‚Ğ°Ñ€Ğ¾Ğ² Ğ¾Ñ‚ Ğ¿Ğ¾Ğ¸ÑĞºĞ° GPU Ğ¸Ğ½ÑÑ‚Ğ°Ğ½ÑĞ¾Ğ² Ğ´Ğ¾ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹Ñ… Ğ²Ğ¸Ğ´ĞµĞ¾.

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ MCP Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ€ÑƒÑ‚Ğ¸Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ¸ Claude Desktop Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ²ÑĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ¼.

---

**ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ Ğ¡ÑÑ‹Ğ»ĞºĞ¸:**

- [Vast.ai Console](https://console.vast.ai)
- [HunyuanVideo-Avatar GitHub](https://github.com/Tencent-Hunyuan/HunyuanVideo-Avatar)
- [MCP Documentation](https://modelcontextprotocol.io/)
- [Claude Desktop](https://claude.ai/desktop)
